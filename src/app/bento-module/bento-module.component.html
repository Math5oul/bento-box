<section class="bento-module">
  <!-- Modal de login admin -->
  @if (showAdminLogin) {
    <app-admin-login-modal
      (loginSuccess)="onAdminLoginSuccess($event)"
      (close)="showAdminLogin = false"
    ></app-admin-login-modal>
  }
  <!-- Modal de login cliente -->
  @if (showClientLogin) {
    <app-login-modal
      (loginSuccess)="onClientLoginSuccess($event)"
      (close)="showClientLogin = false"
    ></app-login-modal>
  }
  <app-header class="header" (search)="onSearch($event)"></app-header>

  <!-- Grid √∫nico quando h√° pesquisa ativa -->
  @if (isSearchActive) {
    <div class="search-results-container">
      <div class="search-header">
        <span class="search-icon">üîç</span>
        <h2 class="search-title">Resultados da Pesquisa</h2>
      </div>

      <app-bento-box
        class="bento-box"
        [data]="filteredProducts"
        [fillers]="fillers || []"
        [options]="options"
        [selectedId]="selectedItem ? selectedItem.id : null"
        (itemClick)="onItemClick($event)"
        (itemEdit)="onItemEdit($event)"
        (itemDelete)="onItemDelete($event)"
      ></app-bento-box>
    </div>
  }

  <!-- Iterar sobre cada categoria quando n√£o h√° pesquisa -->
  @if (!isSearchActive) {
    <div class="categories-container">
      @for (category of orderedCategories; track category; let isFirst = $first) {
        <div class="category-section">
          <!-- Divisor (exceto antes da primeira se√ß√£o) -->
          @if (!isFirst) {
            <div class="category-divider"></div>
          }

          <!-- Cabe√ßalho da categoria -->
          <div class="category-header">
            <span class="category-icon">{{ getCategoryIcon(category) }}</span>
            <h2 class="category-title">{{ getCategoryName(category) }}</h2>
          </div>

          <!-- Bento box para esta categoria -->
          <app-bento-box
            class="bento-box"
            [data]="getProductsByCategory(category)"
            [fillers]="getFillersByCategory(category)"
            [options]="options"
            [selectedId]="selectedItem ? selectedItem.id : null"
            (itemClick)="onItemClick($event)"
            (itemEdit)="onItemEdit($event)"
            (itemDelete)="onItemDelete($event)"
          ></app-bento-box>
        </div>
      }
    </div>
  }

  @if (toolbar && isAdmin) {
    <app-bento-toolbar
      [data]="data"
      [options]="options"
      [selectedItem]="selectedItem"
      (dataModified)="refreshProductGroups()"
      (editCancelled)="reloadAllData()"
    >
    </app-bento-toolbar>
  }

  <app-footer></app-footer>
</section>
