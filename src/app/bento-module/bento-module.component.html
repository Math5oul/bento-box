<section class="bento-module">
  <app-header class="header" (search)="onSearch($event)"></app-header>

  <!-- Grid √∫nico quando h√° pesquisa ativa -->
  @if (isSearchActive) {
    <div class="search-results-container">
      <div class="search-header">
        <span class="search-icon">üîç</span>
        <h2 class="search-title">Resultados da Pesquisa</h2>
      </div>

      <app-bento-box
        class="bento-box"
        [data]="filteredProducts"
        [fillers]="fillers || []"
        [options]="options"
        [selectedId]="selectedItem ? selectedItem.id : null"
        (itemClick)="onItemClick($event)"
        (itemEdit)="onItemEdit($event)"
        (itemDelete)="onItemDelete($event)"
      ></app-bento-box>
    </div>
  }

  <!-- Iterar sobre cada categoria quando n√£o h√° pesquisa -->
  @if (!isSearchActive) {
    <div class="categories-container">
      @for (category of orderedCategories; track category) {
        <div class="category-section">
          <!-- Cabe√ßalho da categoria -->
          <div class="category-header">
            <span class="category-icon">{{ getCategoryIcon(category) }}</span>
            <h2 class="category-title">{{ getCategoryName(category) }}</h2>
          </div>

          <!-- Bento box para esta categoria -->
          <app-bento-box
            class="bento-box"
            [data]="getProductsByCategory(category)"
            [fillers]="getFillersByCategory(category)"
            [options]="options"
            [selectedId]="selectedItem ? selectedItem.id : null"
            (itemClick)="onItemClick($event)"
            (itemEdit)="onItemEdit($event)"
            (itemDelete)="onItemDelete($event)"
          ></app-bento-box>
        </div>
      }
    </div>
  }

  @if (toolbar) {
    <app-bento-toolbar [data]="data" [options]="options" [selectedItem]="selectedItem">
    </app-bento-toolbar>
  }
</section>
