<section
  class="bento"
  #bento
  [ngStyle]="{
    'max-width': options.maxWidth > 0 ? options.maxWidth + 'px' : 'none',
    'margin-inline': 'auto',
  }"
>
  <div
    class="bento-container"
    #bentoContainer
    [ngStyle]="{
      'grid-template-columns': 'repeat(auto-fit, ' + options.cellWidth + 'px)',
      'max-width': currentCols * options.cellWidth + 'px',
      'margin-inline': 'auto',
    }"
  >
    @for (item of data; track $index) {
      <div
        class="bento-item"
        [ngClass]="{
          selected: selectedId === item.id && options.mode === 'edit',
          dragging: draggedItem?.id === item.id,
          'drag-over': dragOverItem?.id === item.id,
        }"
        [attr.draggable]="options.mode === 'edit'"
        (click)="handleItemClick($event, item)"
        (dragstart)="onDragStart($event, item)"
        (dragover)="onDragOver($event, item)"
        (drop)="onDrop($event, item)"
        (dragend)="onDragEnd($event)"
        (dragleave)="onDragLeave($event)"
        (touchstart)="onTouchStart($event, item)"
        (touchmove)="onTouchMove($event)"
        (touchend)="onTouchEnd($event)"
        [ngStyle]="{
          'width.px': item.colSpan * options.cellWidth,
          'height.px': item.rowSpan * options.cellHeight,
          'grid-column-start': item.col + 1,
          'grid-column-end': 'span ' + item.colSpan,
          'grid-row-start': item.row + 1,
          'grid-row-end': 'span ' + item.rowSpan,
          padding: options.gridGap + 'px',
        }"
      >
        <div
          class="component-wrapper"
          [ngStyle]="{
            height: '-webkit-fill-available',
            width: '-webkit-fill-available',
          }"
        >
          <ng-container
            *ngComponentOutlet="item.component; inputs: getComponentInputs(item.inputs)"
          >
          </ng-container>
        </div>

        <!-- Botões de ação no modo de edição -->
        @if (options.mode === 'edit') {
          <div class="edit-actions">
            <button
              class="action-btn edit-btn"
              (click)="onEditItem($event, item)"
              title="Editar conteúdo do item"
              aria-label="Editar item"
            >
              <span class="btn-icon">✏️</span>
            </button>
            <button
              class="action-btn delete-btn"
              (click)="onDeleteItem($event, item)"
              title="Excluir este item"
              aria-label="Excluir item"
            >
              <span class="btn-icon">🗑️</span>
            </button>
          </div>
        }
      </div>
    }
    @if (options.createFillers) {
      @for (item of fillersInGrid; track $index) {
        <div
          class="bento-item__filler"
          [ngStyle]="{
            'width.px': item.colSpan * options.cellWidth,
            'height.px': item.rowSpan * options.cellHeight,
            'grid-column-start': item.col + 1,
            'grid-column-end': 'span ' + item.colSpan,
            'grid-row-start': item.row + 1,
            'grid-row-end': 'span ' + item.rowSpan,
            padding: options.gridGap + 'px',
          }"
        >
          <div *ngComponentOutlet="item.component; inputs: { inputs: item.inputs }"></div>
        </div>
      }
    }
  </div>
</section>
