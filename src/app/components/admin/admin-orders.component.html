<div class="admin-orders">
  <div class="orders-header">
    <h2>📦 Pedidos por Mesa</h2>
  </div>

  @if (isLoading) {
    <div class="loading">Carregando pedidos...</div>
  }

  @if (error) {
    <div class="error">{{ error }}</div>
  }

  @if (!isLoading && !error) {
    @for (mesa of ordersByTable; track mesa.tableNumber) {
      <div class="mesa-block" [attr.data-table-number]="mesa.tableNumber">
        <div class="mesa-title-row">
          <div class="mesa-icon">🪑</div>
          <h3>Mesa {{ mesa.tableNumber }}</h3>
          @if (mesa.orders.length > 0) {
            <span class="mesa-total">
              {{ mesa.orders.length }} pedido{{ mesa.orders.length > 1 ? 's' : '' }}
            </span>
          }
        </div>

        @if (mesa.orders.length === 0) {
          <div class="no-orders">Nenhum pedido nesta mesa.</div>
        }

        <div class="orders-list">
          @for (order of mesa.orders; track order.id) {
            <div class="order-card">
              <div class="order-header">
                <div class="order-avatar">{{ order.clientName.charAt(0) }}</div>
                <div class="order-id-status">
                  <span class="order-id">#{{ order.id }}</span>
                  <span class="order-status" [style.background]="getStatusColor(order.status)">
                    {{ getStatusLabel(order.status) }}
                  </span>
                </div>
                <div class="order-total">R$ {{ order.totalAmount.toFixed(2) || '0.00' }}</div>
              </div>

              <div class="order-details">
                <div class="order-client"><b>Cliente:</b> {{ order.clientName }}</div>
                <div class="order-items">
                  <b>Itens:</b>
                  <ul>
                    @for (item of order.items; track item.productName) {
                      <li>
                        <span class="item-name">{{ item.productName }}</span>
                        @if (item.quantity) {
                          <span class="item-qty">x{{ item.quantity }}</span>
                        }
                      </li>
                    }
                  </ul>
                </div>

                @if (order.notes) {
                  <div class="order-notes">📝 {{ order.notes }}</div>
                }
              </div>
            </div>
          }
        </div>
      </div>
    }
  }
</div>
