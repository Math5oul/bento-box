<app-admin-header></app-admin-header>

<div class="kitchen-dashboard">
  <div class="page-title">
    <h1>ğŸ½ï¸ Painel da Cozinha</h1>
    <p class="subtitle">Acompanhamento de Pedidos em Tempo Real</p>
  </div>

  <!-- Filters Bar -->
  <app-kitchen-filters
    [statuses]="statuses"
    [filterStatus]="filterStatus"
    [orderCount]="orders.length"
    [searchTerm]="searchTerm"
    (filterStatusChange)="filterStatus = $event; loadOrders()"
    (searchTermChange)="onSearchTermChange($event)"
  ></app-kitchen-filters>

  @if (loading) {
    <div class="loading">â³ Carregando pedidos...</div>
  } @else if (error) {
    <div class="error-message">âŒ {{ error }}</div>
  } @else {
    <div class="orders-container">
      <!-- Pedidos Ativos -->
      <app-kitchen-order-list
        [orders]="orders"
        [tablesMap]="tablesMap"
        [canManageOrders]="canManageOrders"
        [canCancelOrders]="canCancelOrders"
        [isHistory]="false"
        title="ğŸ”¥ Ativos"
        [count]="orders.length"
        (itemStatusUpdate)="updateItemStatus($event.order, $event.item, $event.status)"
        (orderCancel)="updateStatus($event, 'cancelled')"
      ></app-kitchen-order-list>

      <!-- HistÃ³rico de Pedidos -->
      @if (historyOrders.length > 0) {
        <div class="history-section">
          <app-kitchen-order-list
            [orders]="historyOrders"
            [tablesMap]="tablesMap"
            [canManageOrders]="false"
            [canCancelOrders]="false"
            [isHistory]="true"
            title="HistÃ³rico"
            [showToggle]="true"
            [isExpanded]="showHistory"
            (toggleExpanded)="showHistory = !showHistory"
          ></app-kitchen-order-list>
        </div>
      }
    </div>
  }
</div>
