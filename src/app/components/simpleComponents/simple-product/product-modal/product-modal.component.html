@if (isOpen) {
  <div class="modal-back">
    <div class="modal-overlay" (mousedown)="close()">
      <div class="modal-content" (mousedown)="$event.stopPropagation()">
        <button class="close-button" (click)="close()">&times;</button>

        <!-- Área scrollável -->
        <div class="modal-scroll-area">
          <app-carrossel [images]="images" [(currentIndex)]="currentImageIndex"> ></app-carrossel>

          <div class="product-info">
            <div class="product-text">
              <h2 class="product-name">{{ productName }}</h2>
              <p class="product-price">{{ getCurrentPrice() | currency: 'BRL' }}</p>
              <p
                class="product-description"
                [innerHTML]="description | sanitize: 'trustedHtml'"
              ></p>

              <!-- Seleção de Tamanhos (apenas se houver mais de 1 tamanho) -->
              @if (shouldShowSizeSelection()) {
                <div class="sizes-selection">
                  <label class="sizes-label">Tamanho:</label>
                  <div class="sizes-buttons">
                    @for (size of sizes; track size.abbreviation) {
                      <button
                        type="button"
                        class="size-btn"
                        [class.selected]="selectedSize?.abbreviation === size.abbreviation"
                        (click)="selectSize(size)"
                      >
                        <span class="size-abbr">{{ size.abbreviation }}</span>
                        <span class="size-name">{{ size.name }}</span>
                        <span class="size-price">{{ size.price | currency: 'BRL' }}</span>
                      </button>
                    }
                  </div>
                </div>
              }

              <div class="quantity-adjuster">
                <button
                  class="quantity-button decrease"
                  (click)="decrementQuantity()"
                  title="Diminuir quantidade"
                >
                  <span>-</span>
                </button>

                <span class="quantity">{{ quantity }}</span>

                <button
                  class="quantity-button increase"
                  (click)="incrementQuantity()"
                  title="Aumentar quantidade"
                >
                  <span>+</span>
                </button>
              </div>
            </div>
            <div class="observations">
              <textarea
                [(ngModel)]="observations"
                placeholder="Adicione observações ao pedido..."
                rows="3"
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Botão fixo (fora da área scrollável) -->
        <div class="modal-actions">
          <button class="submit-button" (click)="submitOrder()">Adicionar ao Carrinho</button>
        </div>
      </div>
    </div>
  </div>
}
